---
title: "DS6372-Project2"
author: "David Wei", "Anish Patel"
date: "7/23/2020"
output: html_document
---

#### Setup & General Libraries
```{r,warning=FALSE,message=FALSE}
library(tidyr)
library(dplyr)
library(ggplot2)
library(tidyverse)

setwd("C:/Users/David/Google Drive/Code & Programming/GitHub/MSDS_6372_Applied-Statistics_Project_2/UCI_Bank_Marketing_Classification_Model/Data Files/")
df <- read.csv("bank-additional-full.csv", header=TRUE, sep=";")
head(df, 5)
```

#### Data Tidying
```{r,warning=FALSE,message=FALSE}
# renaming response variable 'y' to 'Clnt_Subcr'
df <- df %>% rename(clnt.subcr = `y`)
df$clnt.subcr <- factor(df$clnt.subcr)

library(naniar)
# verifying missing data: no missing data found
vis_miss(df) + xlab("Data Columns")

# finding which columns in df are categorical
cat_class <- as.data.frame(sapply(df, class))
cat_class

# exploring the unique data values for all categorical variables
cat_types <- c(2,3,4,5,6,7,8,9,10,15)
for(i in cat_types){
  print(colnames(df[i]))
  print(df %>% count(df[,i]))
}

# converting all "unknown" values back to NA
df_stg <- df
df_stg[df_stg=="unknown"] <- NA
vis_miss(df_stg) + xlab("Data Columns")

# filtering out all NA values from dataset
df_stg <- df_stg %>% filter(!is.na(job) & !is.na(marital) & !is.na(education) & !is.na(default)
                                      & !is.na(housing) & !is.na(loan) & !is.na(contact))
# checking all missing variables filtered out
vis_miss(df_stg) + xlab("Data Columns")
# validating reduction in row totals after filtering missing data
nrow(df_stg) 
nrow(df)
table(df_stg$clnt.subcr)

# Converting all int to numeric value types
int_types <- c(1,11,12,13,14)
for(i in int_types){
  df_stg[,i] <- as.numeric(df_stg[, i])
}

# converting all categorical variables into factors types
df_stg_factors <- df_stg
for(i in cat_types){
  df_stg_factors[, i] <- factor(df_stg_factors[,i])
}

# df with all cleaned data
bank_df <- df_stg
# df with all cleaned AND factored categorical variables
bank_df_num <- df_stg_cat

# Downsampling

```

## EDA
```{r,warning=FALSE,message=FALSE}
library(GGally)
summary(bank_df)
table(df$clnt.subcr)
ncol(df)
num_types <- c(1,11,12,13,14,16,17,18,19,20)
ggpairs(bank_df_num, columns=num_types, aes(colour=clnt.subcr))

# is there a relationship between # of contacts made and the month or week?
library(stringr)
month_cap <- as.data.frame(str_to_title(bank_df$month))
month_ord <- factor(month_cap$month, levels=month.abb)
month_ord %>% ggplot(aes(x=month, y=campaign)) + geom_bar(stat="identity")

bank_df$month <- str_to_title(bank_df$month)
bank_df$month <- factor(bank_df$month, levels=month.abb)
# number of campaigns run per month
bank_df %>% ggplot(aes(x=month, y=campaign,fill=day_of_week)) + geom_bar(stat="identity") + scale_x_discrete(limits=month.abb) + labs(title="# of Campaigns per Month by Day", x="Month", y="# of Campaigns", fill="Day of Week")


```












